<div class="section" [ngClass]="{'collapse':isCollapsed}">
  <form class="section-header" [title]="section_name" [formGroup]="section">
    <div class="section-header-title">
      <div *ngIf="isSectionNameEditable; else editTextBox">{{section.value.section_name}}</div>
      <ng-template #editTextBox>
        <input type="text" class="edit-section-name" placeholder="Section Name" formControlName="section_name" [ngClass]="{'validate-failed': section.get('section_name').touched && section.get('section_name').invalid}">
      </ng-template>
      <div *ngIf="section.get('section_name').touched && section.get('section_name').invalid">
        <small [ngStyle]="{'color':'#F47074'}">*Please enter a section name to continue</small>
      </div>
    </div>
    <div class="section-header-options">
      <ng-container *ngIf="isSectionNameEditable; else editCreateSection">
        <div class="common-option option-menu" [matMenuTriggerFor]="menu">
          <i class="fas fa-ellipsis-h"></i>
        </div>
        <mat-menu #menu="matMenu">
          <button mat-menu-item (click)="onEditSectionName()">Edit section name</button>
          <button mat-menu-item>Delete section</button>
        </mat-menu>
        <div class="common-option collapsable-btn" (click)="onCollapse()">
          <ng-container *ngIf="!isCollapsed; else down">
            <i class="fas fa-caret-up"></i>
          </ng-container>
          <ng-template #down>
            <i class="fas fa-caret-down"></i>
          </ng-template>
        </div>
      </ng-container>
      <ng-template #editCreateSection>
        <div class="common-option divider-right check-btn" (click)="onCreateSection()">
          <i class="fas fa-check"></i>
        </div>
        <div class="common-option cross-btn" (click)="onRemoveSectionName()">
          <i class="fas fa-times"></i>        
        </div>
      </ng-template>
    </div>

  </form>

  <div class="section-body" cdkDropList (cdkDropListDropped)="drop($event)">
    <ng-container *ngFor="let step of stepParameters; let i=index">
      <div class="steps" cdkDrag>
        <app-steps-container [stepType]="step" [stepIndex]="i" [sectionIndex]="sectionIndex" (delete)="onDeleteStep($event)" (outputChange)="onOutputChange($event)" [sectionId]="sectionId"></app-steps-container>
      </div>
    </ng-container>
    <div class="droppable-area" appDroppable (transferedData)="onDropData($event)" (dragover)="allowDrop($event)">
      Drag & drop steps here
    </div>
  </div>
  
</div>