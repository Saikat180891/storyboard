
<div class="overlay" *ngIf="_UIControllerService.getOverlay()" (click)="onOverlayClose()" @fadeIn>

<!-- This is for editing new SOP -->
    <div 
    class="dialog" 
    (keydown.esc)="onEscape($event)" 
    (click)="preventPropagation($event)" 
    *ngIf="_UIControllerService.getOverlayHeader()==createSOP"
    >

      <div class="dialog-group border padding-all color-main-blue">
        <div class="dialog-element">
          <span>{{createSOP}}</span>
          <span class="close" (click)="onClose()"><i class="fas fa-times"></i></span>
        </div>
      </div>
<!-- client name -->
      <div class="dialog-group padding-all margin-top-10 margin-bottom-10">
          <div class="input-box">
              <input 
              type="text" 
              [ngClass]="{'ASN-box':true, 'validators':validateClientName===true}" 
              placeholder="Client Name" 
              [(ngModel)]="clientName"
              appCapitalize>
          </div>
          <small [ngClass]="{'validation-message':validateClientName===true}" *ngIf="validateClientName">
            <em>{{validateClientNameMessage}}</em>
          </small>
      </div>

      <div class="dialog-group padding-all margin-bottom-10">
          <div class="input-box">
              <input 
              type="text" 
              [ngClass]="{'ASN-box':true, 'validators':validateAutomationSystemName===true}" 
              placeholder="Automation System Name" 
              [(ngModel)]="automationSystemName"
              appCapitalize>
          </div>
          <small [ngClass]="{'validation-message':validateAutomationSystemName===true}" *ngIf="validateAutomationSystemName">
            <em>{{validateAutomationSystemNameMessage}}</em>
          </small>
      </div>

      <div class="dialog-group padding-all margin-bottom-10">
          <div class="input-box">
              <input type="text" id="charge-code" placeholder="Charge Code" [(ngModel)]="chargeCode"  [ngClass]="{'validators':validateChargeCode===true}">

              <input
              id="date" 
              placeholder="Due Date" 
              matInput 
              [matDatepicker]="picker" 
              [(ngModel)]="selectedDate" 
              readonly  
              [ngClass]="{'datepicker':true, 'validators':validateSelectedDate===true}"
              [ngStyle]="{'border':border}"
              >
              <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
              <mat-datepicker #picker></mat-datepicker>
          </div>
          <small 
            [ngClass]="{'validation-message':validateChargeCode===true||validateSelectedDate===true}" 
            *ngIf="validateChargeCode||validateSelectedDate">
              <em>{{validateChargeCodeMessage}}</em>
          </small>
          <!-- <small [ngClass]="{'validation-message':validateSelectedDate===true}" *ngIf="validateSelectedDate"><em>Automation system name cannot contain numbers</em></small> -->
      </div>

      <div class="dialog-group padding-all upload height-auto">
        <div class="relative pointer">
          <button mat-stroked-button>
            <img class="preview-logo" *ngIf="imagePath" [src]="imagePath" [alt]="imagePath">
            <span class="client-logo" *ngIf="!imagePath">Upload Client Logo</span>
            <span *ngIf="!imagePath"><small>(Max Size 200px-200px)</small></span>
            <span *ngIf="!imagePath"><i class="fas fa-download"></i>CHOOSE FILE</span>
          </button>
          <input type="file" (change)="onFileSelected($event)"/>
        </div>
      </div>

      <div class="dialog-group padding-all height-auto padding-top-0" id="add-assign">
          <div class="input-box padding-top-0 relative">
            <label for="ASN-box">Assign To</label>
            <input type="text" id="ASN-box" placeholder="Type name or email address" [(ngModel)]="assigneeName" (keyup)="onKeyPress()">
            <div class="autocomplete" *ngIf="options; else load">
              <ng-container *ngFor="let option of options; let i=index">
                  <span class="autocomplete-item" *ngIf="i<3" (click)="onSelect(option)">{{option}}</span>
              </ng-container>
            </div>
            <!-- <ng-template #load>
              <div class="autocomplete">
                <mat-spinner></mat-spinner>
              </div>
            </ng-template> -->
              <button (click)="addAssignee(true)">ADD</button>
          </div>
      </div>

      <div class="dialog-group padding-all height-auto height-max margin-bottom-10">
          <ul *ngIf="userDatas">
            <li *ngFor="let userData of createAssignees" @fadeOut>
              <img [src]="userData[0]" [alt]="userData[0]"/>
              <span>{{userData[1]}}</span>
              <span class="list-close" (click)="onRemove(userData)">
                <i class="fas fa-times"></i>
              </span>
            </li>
          </ul>
      </div>

      <div class="dialog-group padding-all fixed-bottom height-auto margin-bottom-10">
        <div class="button-box">
            <button mat-raised-button color="primary" (click)="onCreateNew()">CREATE NEW</button>
            <button mat-raised-button (click)="onClose()">CANCEL</button>
        </div>
      </div>

    </div>

    <div class="preloader" (click)="preventPropagation($event)" *ngIf="openPreloader">
      <div class="spinner">
        <mat-spinner></mat-spinner>
      </div>
    </div>

<!-- This is for editing SOP -->
  <div class="dialog" (click)="preventPropagation($event)" *ngIf="_UIControllerService.getOverlayHeader()==editSOP">

        <div class="dialog-group border padding-all color-main-blue">
          <div class="dialog-element">
            <span>{{editSOP}}</span>
            <span class="close" (click)="onClose()"><i class="fas fa-times"></i></span>
          </div>
        </div>
  
        <div class="dialog-group padding-all margin-top-10 margin-bottom-10">
            <div class="input-box">
                <input type="text" class="ASN-box" placeholder="Automation System Name" 
                [ngModel]="editAutomationSystemName" 
                (ngModelChange)="onEditASN($event)"
                >
            </div>
        </div>
  
        <div class="dialog-group padding-all margin-bottom-10">
            <div class="input-box">
                <input type="text" class="ASN-box" placeholder="Client Name" 
                [ngModel]="editClientName"
                (ngModelChange)="onEditClientName($event)"
                >
            </div>
        </div>
  
        <div class="dialog-group padding-all margin-bottom-10">
            <div class="input-box">
                <input type="text" id="charge-code" placeholder="Charge Code" 
                [ngModel]="editChargeCode"
                (ngModelChange)="onEditCargeCode($event)"
                >
  
                <input class="datepicker" 
                id="date" placeholder="Due Date" 
                matInput 
                [matDatepicker]="picker" 
                [ngModel]="editSelectedDate" 
                readonly
                >
                <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                <mat-datepicker #picker></mat-datepicker>
            </div>
        </div>
  
        <div class="dialog-group padding-all upload height-auto">
          <div class="relative pointer">
            <button mat-stroked-button>
              <img class="preview-logo" *ngIf="editImagePath" [src]="editImagePath" [alt]="editImagePath">
              <span class="client-logo" *ngIf="!editImagePath">Upload Client Logo</span>
              <span *ngIf="!editImagePath"><small>(Max Size 200px-200px)</small></span>
              <span *ngIf="!editImagePath"><i class="fas fa-download"></i>CHOOSE FILE</span>
            </button>
            <input type="file" (change)="onFileSelected($event)"/>
          </div>
        </div>
  
        <div class="dialog-group padding-all height-auto padding-top-0" id="add-assign">
            <div class="input-box padding-top-0">
              <label for="ASN-box">Assign To</label>
              <input type="text" id="ASN-box" placeholder="Type name or email address" [(ngModel)]="assigneeName">
                <button (click)="addAssignee()">ADD</button>
            </div>
        </div>
  
        <div class="dialog-group padding-all height-auto height-max margin-bottom-10">
            <ul *ngIf="userDatas">
              <li *ngFor="let userData of editAssignees" @fadeOut>
                <img [src]="userData.image"/>
                <span>{{userData.assignTo}}</span>
                <span class="list-close" (click)="onRemove(userData)">
                  <i class="fas fa-times"></i>
                </span>
              </li>
            </ul>
        </div>
  
        <div class="dialog-group padding-all fixed-bottom height-auto margin-bottom-10">
          <div class="button-box">
            <button mat-raised-button color="primary" (click)="onSave()">SAVE</button>
            <button mat-raised-button (click)="onClose()">CANCEL</button>
          </div>
        </div>
  
      </div>
  </div>
    
