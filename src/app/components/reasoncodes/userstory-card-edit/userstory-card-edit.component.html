<div class="side-container">
  <div class="heading">
    <span
      matTooltip="{{ editUSData.us_name }}"
      matTooltipPosition="above"
      *ngIf="editUSData.us_name.length > 20; else smallUsName"
      >{{ editUSData.us_name }}</span
    >
    <ng-template #smallUsName>
      <span class="wrap-content">{{ editUSData.us_name }}</span>
    </ng-template>
    <span (click)="onClose()" class="close"><i class="fas fa-times"></i></span>
  </div>
  <div class="form">
    <div class="form-group">
      <div class="input-container md">
        <div class="title" [ngClass]="{ warning: userStoryNumberValidator }">
          U/S#
        </div>
        <div class="editable">
          <input
            type="number"
            placeholder="Ex: 1"
            [(ngModel)]="editUSData.us_number"
          />
        </div>
      </div>
      <div class="input-container md">
        <div class="title" [ngClass]="{ warning: userStoryNameValidator }">
          User Story Name
        </div>
        <div class="editable">
          <input
            maxlength="100"
            type="text"
            placeholder="Ex: User Story 1"
            [(ngModel)]="editUSData.us_name"
            [ngStyle]="{ width: '250px' }"
          />
        </div>
      </div>
    </div>

    <div class="form-group">
      <div class="input-container md">
        <div
          class="title"
          [ngClass]="{ warning: userStoryReasonCodeValidator }"
        >
          Epic
        </div>
        <div class="editable">
          <normal-dropdown
            (optionSelected)="editUSData.rc_name = $event.status"
            [options]="reasonCodeOptions"
            [defaultOption]="
              editUSData.rc_name ? editUSData.rc_name : 'Unassigned'
            "
          ></normal-dropdown>
        </div>
      </div>
      <div class="input-container md">
        <div
          class="title"
          [ngClass]="{ warning: userStorySprintNameValidator }"
        >
          Sprint Name
        </div>
        <div class="editable">
          <normal-dropdown
            (optionSelected)="onSprintSelect($event)"
            [options]="sprintOptions"
            [defaultOption]="
              editUSData.sprint_name ? editUSData.sprint_name : 'Unassigned'
            "
          ></normal-dropdown>
        </div>
      </div>
    </div>
    <div class="h-divider"></div>

    <div class="form-group h-space-equally">
      <div class="input-container extra">
        <div class="title" [ngClass]="{ warning: userStoryPriorityValidator }">
          Priority
        </div>
        <div class="editable">
          <colored-dropdown
            (optionSelected)="editUSData.priority = $event.status"
            [options]="priorityOptions"
            [defaultOption]="editUSData.priority"
          ></colored-dropdown>
        </div>
      </div>
      <div class="input-container sm">
        <div class="title">Productivity</div>
        <div class="editable">
          <input
            class="text-center"
            type="number"
            placeholder="------"
            readonly
            [(ngModel)]="productivity"
          />
          <!-- <span class="text-center">{{productivity}}</span> -->
        </div>
      </div>
      <div class="input-container sm">
        <div class="title" [ngClass]="{ warning: userStoryDevHrsValidator }">
          Dev Hrs
        </div>
        <div class="editable">
          <input
            type="text"
            placeholder="Ex: 23"
            [(ngModel)]="editUSData.dev_hrs"
            (keyup)="onUpdateProductivity()"
          />
        </div>
      </div>
      <div class="input-container sm">
        <div class="title" [ngClass]="{ warning: userStoryBenefitValidator }">
          Benefits
        </div>
        <div class="editable">
          <input
            type="text"
            placeholder="Ex: 3"
            [(ngModel)]="editUSData.ftes"
            (keyup)="onUpdateProductivity()"
          />
        </div>
      </div>
    </div>
    <div class="h-divider"></div>

    <div class="form-group">
      <div class="input-container md">
        <div class="title">Rules Approved</div>
        <div class="editable align-center pad-right">
          <mat-slide-toggle
            [checked]="editUSData.rules_approved"
            (change)="editUSData.rules_approved = $event.checked"
          ></mat-slide-toggle>
        </div>
      </div>
      <div class="input-container md">
        <div class="title">Test Cases Verified</div>
        <div class="editable align-center">
          <mat-slide-toggle
            [checked]="editUSData.verified_test_cases"
            (change)="editUSData.verified_test_cases = $event.checked"
          ></mat-slide-toggle>
        </div>
      </div>
    </div>
    <div class="h-divider"></div>

    <div class="form-group">
      <div class="input-container lg extra" [ngStyle]="{ width: '220px' }">
        <div class="title" [ngClass]="{ warning: userStoryStatusValidator }">
          Status
        </div>
        <div class="editable">
          <colored-dropdown
            (optionSelected)="onSelectStatus($event)"
            [options]="statusOptions"
            [defaultOption]="editUSData.status"
          ></colored-dropdown>
        </div>
      </div>
      <div class="input-container">
        <div class="title">Description</div>
        <div class="editable">
          <input
            type="text"
            placeholder="Add description here"
            maxlength="100"
            [(ngModel)]="editUSData.notes"
            maxlength="100"
          />
        </div>
      </div>
    </div>
    <div class="h-divider"></div>

    <div class="form-group">
      <div class="input-container md" [ngStyle]="{ 'margin-top': '17px' }">
        <div class="title">Planned Delivery</div>
        <div class="editable relative">
          <input
            type="text"
            maxlength="100"
            placeholder="Start Date"
            [matDatepicker]="etd"
            (dateChange)="onDatePickerClosePD($event)"
            [value]="editUSData.planned_delivery"
            [ngStyle]="{ 'padding-left': '30px' }"
            readonly
          />
          <div class="etd-date-picker">
            <mat-datepicker-toggle
              matSuffix
              [for]="etd"
            ></mat-datepicker-toggle>
            <mat-datepicker #etd></mat-datepicker>
          </div>
        </div>
      </div>
      <div class="input-container md" [ngStyle]="{ width: '130px' }">
        <div class="title">
          <mat-checkbox
            (change)="onRDChecked($event.checked)"
            [checked]="checked"
          >
            Revised Delivery</mat-checkbox
          >
        </div>
        <div
          class="editable relative"
          *ngIf="activateRevisedDelivery; else activateRD"
        >
          <input
            type="text"
            maxlength="100"
            placeholder="None"
            (dateChange)="onDatePickerCloseRD($event)"
            [value]="editUSData.revised_delivery"
            [matDatepicker]="petd"
            [ngStyle]="{ 'padding-left': '30px' }"
            readonly
          />
          <div class="etd-date-picker">
            <mat-datepicker-toggle
              matSuffix
              [for]="petd"
            ></mat-datepicker-toggle>
            <mat-datepicker #petd></mat-datepicker>
          </div>
        </div>
        <ng-template #activateRD> </ng-template>
      </div>
    </div>

    <div class="form-group btn-group">
      <button class="btn btn-blue" (click)="onSaveAll()">Save Changes</button>
      <button class="btn btn-flat-ash" (click)="onClose()">Cancel</button>

      <span
        class="message"
        *ngIf="
          userStoryNumberValidator ||
          userStoryNameValidator ||
          userStoryPriorityValidator ||
          userStorySprintNameValidator ||
          userStoryStatusValidator
        "
        >Please enter the mandatory fields</span
      >
    </div>
  </div>
</div>
